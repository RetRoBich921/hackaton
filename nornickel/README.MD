# Проект по Сегментации Дефектов на Изображениях

## Описание Проекта
Данный проект направлен на разработку системы автоматического обнаружения и сегментации дефектов на промышленных изображениях с использованием глубокого обучения. Основное назначение системы — повышение эффективности и точности диагностики дефектов за счет применения современной архитектуры нейронных сетей.

---

## Основные Характеристики
- **Архитектура**: DeepLabV3+ с ResNet101
- **Задача**: Бинарная сегментация (дефект/фон)
- **Фреймворк**: PyTorch
- **Размер входных изображений**: 256x256 пикселей

---

## Структура Проекта
```
nornickel/
├── main.ipynb                # Основной файл с кодом
├── README.md                 # Документация проекта
└── datasets/                 # Каталог для данных
    ├── images/              # Изображения
    │   ├── train/          # Тренировочные изображения
    │   └── val/            # Валидационные изображения
    └── labels/             # Маски
        ├── train/          # Тренировочные маски
        └── val/            # Валидационные маски
```

---

## Процесс Обучения

### 1. Предобработка Данных
- Изменение размера изображений до 256x256 пикселей.
- Конвертация изображений в RGB формат.
- Нормализация данных по статистикам ImageNet.

### 2. Разделение Данных
- **Тренировочная выборка**: 80%
- **Валидационная выборка**: 20%

### 3. Настройки Обучения
- **Оптимизатор**: Adam (lr=1e-4)
- **Функция потерь**: CrossEntropyLoss
- **Количество эпох**: 50
- **Размер батча**: 8

---

## Результаты
- Модель успешно обучена для бинарной сегментации дефектов.
- Основная метрика качества — IoU (Intersection over Union).
- Результаты предсказаний визуализированы и сохранены для дальнейшего анализа.

---

## Экспорт Модели
При запуске `main.ipynb` на платформе Kaggle (с использованием одной GPU) генерируется файл модели в формате ONNX:
```
/kaggle/working/deeplabv3_plus_model.onnx
```

**Важно**: Экспортированный файл необходимо добавить в архив `nornickel_dockerfile.zip` для дальнейшего использования.

---

## Требования
- Python 3.x
- PyTorch
- torchvision
- numpy
- PIL
- sklearn
- tqdm
- matplotlib

---

## Ссылки
- **Видео демонстрации проекта**: [YouTube](https://youtu.be/i7mqUOjV_w0)

---

## Примечание
Обучение проводилось на платформе Kaggle с использованием одной GPU. При необходимости переноса на другие платформы рекомендуется учитывать специфику аппаратного обеспечения.

